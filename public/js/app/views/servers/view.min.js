define(function(a){var e=a("jquery"),l=a("underscore"),k=a("backbone"),i=a("marionette"),b=a("app/collections/mods"),c=a("app/views/servers/form"),d=a("app/views/servers/info"),m=a("app/views/servers/missions/index"),g=a("app/views/servers/mods/list"),j=a("app/views/servers/parameters/list"),h=a("app/views/servers/players"),f=a("text!tpl/servers/view.html");return i.LayoutView.extend({template:l.template(f),regions:{infoView:"#tab-info",missionsView:"#tab-missions",modsView:"#tab-mods",parametersView:"#parameters",playersView:"#tab-players",settingsView:"#settings"},events:{"click .nav-tabs a":"tabs",submit:"save"},modelEvents:{change:"serverUpdated"},initialize:function(n){this.missions=n.missions;this.mods=n.mods},onRender:function(){this.infoView.show(new d({model:this.model}));this.missionsView.show(new m({missions:this.missions,model:this.model}));this.modsView.show(new g({collection:this.mods,server:this.model}));this.parametersView.show(new j({model:this.model}));this.playersView.show(new h({model:this.model}));this.settingsView.show(new c({model:this.model}))},serverUpdated:function(){this.infoView.currentView.render();this.modsView.currentView.render();this.parametersView.currentView.render();this.playersView.currentView.render();this.settingsView.currentView.render()},save:function(p){p.preventDefault();var n=this;var q=this.model.get("id");var o=this.settingsView.currentView.serialize();l.extend(o,this.missionsView.currentView.serialize());l.extend(o,this.modsView.currentView.serialize());l.extend(o,this.parametersView.currentView.serialize());this.model.save(o,{success:function(){var r=n.model.get("id");if(q!=r){k.history.navigate("#servers/"+r,true)}else{n.serverUpdated()}},error:function(){alert("Error :(")}})},tabs:function(n){n.preventDefault();e(e(n.target).attr("href")).tab("show")}})});